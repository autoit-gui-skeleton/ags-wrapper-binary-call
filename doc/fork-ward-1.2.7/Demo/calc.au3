; =============================================================================
;  AutoIt BinaryCall UDF Demo
;  Author: Ward
; =============================================================================

#Include "..\BinaryCall.au3"

; Scripts generated by BinaryCall Tool without modification

If @AutoItX64 Then
	Local $Code = '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' & _
		'r6l+DXyGqEYU4nUVS6beawf2B3xcV+LY0sv+pwlXOeNhK4NBUDzZWVwSwaoqme57VSn07zWzxjHrqmbgSh7Rk1sSccmcjO6zQlp0MO7MouC/U16WeVVQakk/imHo8lNS2KPNlITzWVdof23IGxmqF/G3SOiRTmi/6TSHkQczpYUdQkTGAxRuUHzv82tYornOKDfhXSHWv14DlkV0PZ91N608Hbl1C4Na5K7YEhtTbnTqJSLT4VejhVs3e3M6AH/77SFsXmxSWWyplSSok1Hxy7Lrfa1kxHjdrhmsij3i+0Vjeoay63YjlNYpfMPc/0xWUfmQgvcRmwRawdL69bhp4dJs2ejX7KvY1g+r7EGOM1ILOOXlyhMNGZNB5zUcIFuWDOZ6MDqiwehGg0OkJ6jKIpCsNBpdblqLPj5rWSoOzKWpNeQa6IznC2cu4S2FnvLuafBfMIq21Xz53yeDY+cH0Qr1i7Nd+0WhYNE15e1Yzat3Q0u28Jii4xuzeLZZRfC5DuLGNsXtGHpOQlKwwSmV0NeJhcqVZEZzi/rmbv9+b9+29M/hxUrQlOwb3vTvFn51wBBpYNMcj8Y7lrHku6NahH3jJ5VvZmoE+TxrOHsxSpke9YoiHKrGiimrI7nNyTLIG9/MK+S21nuoaud4Y8gbRt2VnoPtS4CZ03pQ5vp36d6wYwylIAE+DMHemuPjCqiOINCKydxaDkjop8093IDTdZ88MChHbHutmGEC6D9ndsIcTF5RQeZxqfxpFSDhEUwmgiu2sYQzT58dASAj7EbOH5DLmY9k/w0MTMu0gn4hkRqJVjhthrp1MQHypA2Y4iPtzZjluVhNJygjNgKchslQkZsY8Cqav3D6aEJtafQR78Gb1AFYAtBdfF+y+eBAXtNa4zV5fbkcZxXb67T28s3it9oXgPgmr0+tQqQAmywD85rRmqE+BrlNw/EJfJy94zOzVqpkBFVKCqvcjJ3WUcqMLS1MLh3DojMxs9hfUa2HAZ9387uGWY0bQQcwSjyPJeuu6mdxdqo5+XchpzeubNo8jbD8rT0G0hhHKpvM9pO/Gv1bDc1dlb0M7GmKWKP3uYX2pm1eKYOWdlMbK0uqMnJ7/R4MfCJHF63Pb229vZVIBCDvf2PqNrdFqr4ozA7gmPWYQbQNLxzJXV2sS7X4TxbFGXaGlLeW/O3RI8LnPZM6f1n18pU0fKYtuPUW7xY+si/5ZOPsd58B8Oo+/V3gk+Che6u9KyD4W3lv/r4alRmAe2YxmbHi+hFmnF2NbOccN5fsazHBil6LtqM54Eyw+yfRvfjtx0KwAbCKdRGGSvTMy6rCA+gay4X0CETz1vqIT5pSPyBw7RQRHg=='
	Local $Reloc = 'AwAAAAQEAAAAAAAAAAABABN2P56AAA=='
	Local $Symbol[] = ["map_init","map_clear","map_find","map_add","map_lookup","print_val","reset","lex","match_char","match_eof","match_num","match_variable","resolve_variable","printtab","parse_rest_var","parse_expr","parse_num_op","parse_rest_num_op","parse_factor","parse_rest_term","parse_term","parse_rest_expr","parse","usage","main","level","bpos","argp","arg"]

	Local $CodeBase = _BinaryCall_Create($Code, $Reloc)
	If @Error Then Exit MsgBox(16, "_BinaryCall_Create Error", _BinaryCall_LastError())
	Local $SymbolList = _BinaryCall_SymbolList($CodeBase, $Symbol)
	If @Error Then Exit MsgBox(16, "_BinaryCall_SymbolList Error", _BinaryCall_LastError())
EndIf

If Not @AutoItX64 Then
	Local $Code = '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' & _
		'jVJSoDQtxEuchgH3yfkqkgE4gN/QQTqVUK4KZf5BmthJVGoHAi9unoLFyXevYD+9/A3rTADy9ohOL6KCvLgn9XwV6GdO5wFvHQ9vz8s1ALYrtPRpwsVMxsX9fCpMXyyymd9BWA6KCx5rkL5aROuCiLS4vUJGMTzBfkDoQZ3XSGgCoKLgwlolj3ovOt127LYM1sYbXlXRpdY4gQB9+wVrwSE0DUUQQNOv1RZay3jFgWfq3xwIXPXSqZio0q2DmX5Lyx6r9+PIZPa7uUzaeZpzleCU2VkLeRhbjXIwRCj+zVO/T9sAs5Jyg1LFijkD5KwR3wk0isPunE/BhpLlIa7a3Ne6Js9DIYIb3PZkuTCaerv9SoB0JqKubB3Vom/UpEHchlbYg0SULoJ8tV7AyBGsHhHybPqLr/y5z+tEN2n3gFwGZI5xdSACp4ZElue2nSxnzNgjyRHGEXdibpFnhNWRug4y7DtHUis8BNHcBN5Y4uAF4R9Lye/vUDsAXe2MlTmYJhPTg0IU3v2iRk8qjuL4yjJV9B1drijRiLWX5nnuYQo0Cgx+z5x8KefJ65mKcXoWLqWpFGlPvgJWk6305HTqwIyjyvq7rKjM9KzQwad67UlzSzcZO2YzAWjcCXnapOGxlZxMrFi5x4C9JLwT+QBMeE/DJxPtyX4nCDvSON2ELHsMfW9FCOnH2q7Gqm1sLyIHQMYFcAKUgeOdewC8KwFuGZx9+t8xpZc6gFUekXWWSOlZxBYjZsPj319Fq6rKH8upAblpG2PxWTlRZnaNjd+P6eQ3IqRf9KA0fzGxjne2CRnAu2tN/mPUgptAB1aHXeco+jkoob6qGS6sfk4rPn3Et3t10A/IPA0b+IzIgdZzDap5DyMXO0xzKQ+078eq9ofbtWM43a+MfGsIBLa3piZ/b5Y+ORmWTqPNWME1P5ObZYihyiqoZfzy3UyOOlTNP55XnILJX+pWOyBVDR3+T1VPtGS5646ZL81ATBgwsU/EwN6q7yQDGVo5KXokwWNVVldra8LsFySz6ojNQ2nDHV3WO5HueLmkcd7LN1zAQlrbKCW0ZiLsb4D8UAIvYpxXn4VumkWEFVf1+BWvi1j9vO9/hxkVE7ZJbZXFPKwXF9L8qQ66SQrajMyv+cCR35jcSLdGc6EnzvXNCSi7r3c9S4QQE6kac861bALwXvFu+w3P9ZMA'
	Local $Reloc = 'AwAAAAS+AAAAAAAAAAABABsWn8jyoHAFMJE2OSwkXVb50K/cidocKHDusZTz6be7vUl8EiZKJFDjmESqAneKNSAzcP9K94tLMZfnIINLrNItP1L7kkEY3FGenT5M2slEZTL89CyPR9Ckd8tfOymmJTPdZM7ixEKYpSXNHDrd/2pMrfMShbuO42tnoAhK6JJ62iUJmC+fMq1RlXe7Egpz7uO2I/sS5LPpbU9KzcPgi1drtgBySMa0TkP3IGDG62CdmIiEGVK3Fq3oAA=='
	Local $Symbol[] = ["map_init","map_clear","map_find","map_add","map_lookup","print_val","reset","lex","match_char","match_eof","match_num","match_variable","resolve_variable","printtab","parse_rest_var","parse_expr","parse_num_op","parse_rest_num_op","parse_factor","parse_rest_term","parse_term","parse_rest_expr","parse","usage","main","level","bpos","argp","arg"]

	Local $CodeBase = _BinaryCall_Create($Code, $Reloc)
	If @Error Then Exit MsgBox(16, "_BinaryCall_Create Error", _BinaryCall_LastError())
	Local $SymbolList = _BinaryCall_SymbolList($CodeBase, $Symbol)
	If @Error Then Exit MsgBox(16, "_BinaryCall_SymbolList Error", _BinaryCall_LastError())
EndIf


; Redirect stdin/stdout/stderr to default console "CON"

_BinaryCall_StdinRedirect("CON")
_BinaryCall_StdoutRedirect("CON")
_BinaryCall_StderrRedirect("CON")

Dim $Argc, $Argv = _BinaryCall_CommandLineToArgv('calc 5+5*5', $Argc)
DllCallAddress("none:cdecl", DllStructGetData($SymbolList, "main"), "int", $Argc, "ptr", $Argv)

Dim $Argc, $Argv = _BinaryCall_CommandLineToArgv('calc 0x30', $Argc)
DllCallAddress("none:cdecl", DllStructGetData($SymbolList, "main"), "int", $Argc, "ptr", $Argv)

Dim $Argc, $Argv = _BinaryCall_CommandLineToArgv('calc (123456 % 51)/12', $Argc)
DllCallAddress("none:cdecl", DllStructGetData($SymbolList, "main"), "int", $Argc, "ptr", $Argv)

Dim $Argc, $Argv = _BinaryCall_CommandLineToArgv('calc', $Argc)
DllCallAddress("none:cdecl", DllStructGetData($SymbolList, "main"), "int", $Argc, "ptr", $Argv)
